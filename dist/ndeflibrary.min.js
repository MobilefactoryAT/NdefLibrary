/*! lib-ndeflibrary - v0.0.1 - 2014-03-17 - Sebastian HÃ¶barth */
(function(){function e(e){"use strict";e.NdefLibrary=function(e){return e=e||{},this}}function t(e){"use strict";e.NdefLibrary}function r(e){"use strict";var t=e.NdefLibrary,r=t.NdefUriRecord=function(){this.RawUri=[],this.Uri="",t.NdefRecord.call(this,t.NdefRecord.TypeNameFormatType.NfcRtd,t.NdefUriRecord.UriType)};t.NdefUriRecord.UriType="U".getBytes(),t.NdefUriRecord.Abbreviations=["","http://www.","https://www.","http://","https://","tel:","mailto:","ftp://anonymous:anonymous@","ftp://ftp.","ftps://","sftp://","smb://","nfs://","ftp://","dav://","news:","telnet://","imap:","rtsp://","urn:","pop:","sip:","sips:","tftp:","btspp://","btl2cap://","btgoep://","tcpobex://","irdaobex://","file://","urn:epc:id:","urn:epc:tag:","urn:epc:pat:","urn:epc:raw:","urn:epc:","urn:nfc:"],t.NdefUriRecord.isRecordType=function(e){return null==e.getType()||0==e.getType().length?!1:e.getTypeNameFormat()==t.NdefRecord.TypeNameFormatType.NfcRtd&&d(e.getType(),t.NdefUriRecord.UriType)},r.prototype=new t.NdefRecord,r.prototype.constructor=t.NdefUriRecord,r.prototype.getRawUri=function(){if(null==this.getPayload()||0==this.getPayload().length)return null;var e=this.getPayload()[0];0!=e&&console.log("NdefExceptionMessages.ExRawUriNoAbbreviation");var t=Array(this.getPayload().length-1),r=this.getPayload();return a(r,1,t,0,r.length-1),t},r.prototype.setRawUri=function(e){var t=Array(e.length+1);t[0]=0,a(e,0,t,1,e.length),this.setPayload(t)},r.prototype.setUri=function(e){for(var r=e,n=0,o=1;t.NdefUriRecord.Abbreviations.length>o;o++)if(r.startsWith(t.NdefUriRecord.Abbreviations[o])){n=o;break}t.NdefUriRecord.Abbreviations[n].length;var s=r.replace(t.NdefUriRecord.Abbreviations[n],""),d=i(s),p=Array(d+1);p[0]=n;var g=encodeURI(s),l=g.getBytes();a(l,0,p,1,l.length),this.setPayload(p)},r.prototype.getUri=function(){var e=this.getPayload();if(null==e||0==e.Length)return"";var r=e[0];r>=t.NdefUriRecord.Abbreviations.length&&(r=0);var n=Array(e.length-1);return a(e,1,n,0,e.length-1),t.NdefUriRecord.Abbreviations[r].concat(decodeURI(p(n)))}}function n(e){"use strict";var t=e.NdefLibrary,r=t.NdefRecord=function(){if(this._typeNameFormat=t.NdefRecord.TypeNameFormatType.Empty,this._type=[],this._id=[],this._payload=[],2==arguments.length)this._typeNameFormat=arguments[0],null!=arguments[1]&&this.setType(arguments[1]);else if(1==arguments.length){var e=arguments[0];null!=e.getType()&&this.setType(e.getType()),null!=e.getId()&&this.setId(e.getId()),null!=e.getPayload()&&this.setId(e.getPayload()),this._typeNameFormat=e.getTypeNameFormat()}else this._typeNameFormat=t.NdefRecord.TypeNameFormatType.Empty};r.TypeNameFormatType={Empty:0,NfcRtd:1,Mime:2,Uri:3,ExternalRtd:4,Unknown:5,Unchanged:6,Reserved:7},r.prototype.getId=function(){return this._id},r.prototype.setId=function(e){return null==e?(this._id=null,void 0):(this._id=[],a(e,this._id,e.length),void 0)},r.prototype.getType=function(){return this._type},r.prototype.setType=function(e){return null==e?(this._type=null,void 0):(this._type=[],a(e,this._type,e.length),void 0)},r.prototype.getPayload=function(){return this._payload},r.prototype.setPayload=function(e){return null==e?(this._payload=null,void 0):(this._payload=[],a(e,this._payload,e.length),void 0)},r.prototype.getTypeNameFormat=function(){return this._typeNameFormat},r.prototype.setTypeNameFormat=function(e){this._typeNameFormat=e},r.prototype.checkSpecializedType=function(){},r.prototype.checkIfValid=function(){if(this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unchanged||this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unknown){if(null!=this._type&&0!=this._type.length)throw"NdefExceptionMessages.ExRecordUnchangedTypeName"}else if(this._typeNameFormat!=t.NdefRecord.TypeNameFormatType.Empty&&(null==this._type||0==this._type.length))throw"NdefExceptionMessages.ExRecordNoType";if(this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unchanged&&null!=this._id&&0!=this._id.length)throw"NdefExceptionMessages.ExRecordUnchangedId";return!0}}function o(e){"use strict";var t=e.NdefLibrary,r=t.NdefMessage=function(){this._records=[],null!=arguments&&arguments.length>0&&a(arguments,this._records,arguments.length)};r.prototype.length=function(){return null==this._records?0:this._records.length},r.prototype.getRecords=function(){return this._records},r.prototype.push=function(e){null!=e&&this._records.push(e)},r.prototype.clear=function(){this._records=[]},t.NdefMessage.fromByteArray=function(e){for(var r=new t.NdefMessage,n=!1,o=!1,i=[],d=new t.NdefRecord,p=0;e.length>p;){var g=0!=(128&e[p]),l=0!=(64&e[p]),h=0!=(32&e[p]),u=0!=(16&e[p]),f=0!=(8&e[p]),y=7&e[p];if(g&&n)throw"NdefExceptionMessages.ExMessageBeginLate";if(!g&&!n)throw"NdefExceptionMessages.ExMessageBeginMissing";if(g&&!n&&(n=!0),l&&o)throw"NdefExceptionMessages.ExMessageEndLate";if(l&&!o&&(o=!0),h&&y!=t.NdefRecord.TypeNameFormatType.Unchanged&&i.length>0)throw"NdefExceptionMessages.ExMessagePartialChunk";var c=1;if(c+=u?1:4,c+=f?1:0,p+c>=e.length)throw"NdefExceptionMessages.ExMessageUnexpectedEnd";var m=e[++p];if(y==t.NdefRecord.TypeNameFormatType.Unchanged&&0!=m)throw"NdefExceptionMessages.ExMessageInvalidChunkedType";var N;u?N=e[++p]:(N=e[++p]<<24,N|=e[++p]<<16,N|=e[++p]<<8,N|=e[++p]<<0);var v;v=f?e[++p]:0;var T=m+N+v;if(p+T>=e.length)throw"NdefExceptionMessages.ExMessageUnexpectedEnd";if(y==t.NdefRecord.TypeNameFormatType.Unchanged&&0!=v)throw"NdefExceptionMessages.ExMessageInvalidChunkedId";if(y!=t.NdefRecord.TypeNameFormatType.Unchanged&&d.setTypeNameFormat(y),m>0){var R=[];a(e,++p,R,0,m),d.setType(R),p+=m-1}if(v>0){var U=[];a(e,++p,U,0,v),d.setId(U),p+=v-1}if(N>0){var _=[];a(e,++p,_,0,N),d.setPayload(_),h?s(i,_):y==t.NdefRecord.TypeNameFormatType.Unchanged?(s(i,_),d.setPayload(i)):d.setPayload(_),p+=N-1}if(h||(r.push(d),d=new t.NdefRecord),!h&&o)break;++p}if(!n&&!o)throw"NdefExceptionMessages.ExMessageNoBeginOrEnd";return r},r.prototype.toByteArray=function(){var e=this._records.length;if(0==e){var r=new t.NdefMessage(new t.NdefRecord);return r.toByteArray()}for(var n=[],o=0;e>o;o++){var a=this._records[o],i=a.getTypeNameFormat();if(0==o&&(i|=128),o==e-1&&(i|=64),(null==a.getPayload()||255>a.getPayload().length)&&(i|=16),null!=a.getId()&&a.getId().length>0&&(i|=8),n.push(i),null!=a.getType()?n.push(a.getType().length):n.push(0),null==a.getPayload())n.push(0);else if(0!=(16&i))n.push(a.getPayload().length);else{var d=a.getPayload().length;n.push(d>>24),n.push(d>>16),n.push(d>>8),n.push(255&d)}null!=a.getId()&&0!=(8&i)&&n.push(a.getId().length),null!=a.getType()&&a.getType().length>0&&s(n,a.getType()),null!=a.getId()&&a.getId().length>0&&s(n,a.getId()),null!=a.getPayload()&&a.getPayload().length>0&&s(n,a.getPayload())}return n}}const a=function(){var e,t,r,n=0,o=0;2===arguments.length?(e=arguments[0],t=arguments[1],r=e.length):3===arguments.length?(e=arguments[0],t=arguments[1],r=arguments[2]):5===arguments.length&&(e=arguments[0],n=arguments[1],t=arguments[2],o=arguments[3],r=arguments[4]);for(var a=n,s=o;r+n>a;a++,s++){if(null===t[s])throw"array index out of bounds exception";t[s]=e[a]}},s=function(e,t){var r,n,o,a=0,s=0;r=t,a=0,n=e,s=e.length,o=t.length;for(var i=a,d=s;o+a>i;i++,d++){if(null===n[d])throw"array index out of bounds exception";n[d]=r[i]}},i=function(e){var t=encodeURI(e);if(-1!=t.indexOf("%")){var r=t.split("%").length-1;0==r&&r++;var n=t.length-3*r;r+=n}else r=t.length;return r},d=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var r=0;e.length>r;++r)if(e[r]!==t[r])return!1;return!0};String.prototype.startsWith=function(e){return this.slice(0,e.length)==e},String.prototype.getBytes=function(){for(var e=[],t=0;this.length>t;++t)e.push(this.charCodeAt(t));return e};const p=function(e){for(var t="",r=0;e.length>r;r++)t+=String.fromCharCode(parseInt(e[r]));return t};var g=Function,l=(new g("return this")(),function(a){return e(a),t(a),n(a),o(a),r(a),a.NdefLibrary});"function"==typeof define&&define.amd?define(function(){return l({})}):l(this)})(this);