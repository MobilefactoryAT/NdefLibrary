/*! lib-ndeflibrary - v0.0.1 - 2014-03-18 - Sebastian HÃ¶barth */
(function(){function e(e){"use strict";e.NdefLibrary=function(e){return e=e||{},this}}function t(e){"use strict";e.NdefLibrary}function r(e){"use strict";var t=e.NdefLibrary,r=t.NdefAndroidAppRecord=function(){if(this.packageName="",1==arguments.length){if(t.NdefRecord.call(this,arguments[0]),!t.NdefAndroidAppRecord.isRecordType(this))throw"NdefException(NdefExceptionMessages.ExInvalidCopy)"}else t.NdefRecord.call(this,t.NdefRecord.TypeNameFormatType.ExternalRtd,t.NdefAndroidAppRecord.AndroidAppRecordType)};t.NdefAndroidAppRecord.AndroidAppRecordType="android.com:pkg".getBytes(),r.prototype=new t.NdefRecord,r.prototype.constructor=t.NdefAndroidAppRecord,t.NdefAndroidAppRecord.isRecordType=function(e){return null==e.getType()||0==e.getType().length?!1:e.getTypeNameFormat()==t.NdefRecord.TypeNameFormatType.ExternalRtd&&g(e.getType(),t.NdefAndroidAppRecord.AndroidAppRecordType)},r.prototype.setPackageName=function(e){if(null==e)return this.setPayload(null),void 0;var t=encodeURI(e),r=t.getBytes();this.setPayload(r)},r.prototype.getPackageName=function(){return null==this.getPayload()||0==this.getPayload().length?"":decodeURI(f(this.getPayload()))}}function o(e){"use strict";var t=e.NdefLibrary,r=t.NdefSocialRecord=function(){this.socialUserName="",this.socialType=t.NdefSocialRecord.NfcSocialType.Twitter,1==arguments.length?t.NdefUriRecord.call(this,arguments[0]):t.NdefUriRecord.call(this)};r.prototype=new t.NdefUriRecord,r.prototype.constructor=t.NdefSocialRecord,t.NdefSocialRecord.NfcSocialType={Twitter:0,LinkedIn:1,Facebook:2,Xing:3,VKontakte:4,FoursquareWeb:5,FoursquareApp:6,Skype:7,GooglePlus:8},t.NdefSocialRecord.SocialTagTypeUris=["http://twitter.com/{0}","http://linkedin.com/in/{0}","http://facebook.com/{0}","http://xing.com/profile/{0}","http://vkontakte.ru/{0}","http://m.foursquare.com/v/{0}","foursquare://venues/{0}","skype:{0}?call","https://plus.google.com/{0}"],r.prototype.updatePayload=function(){var e=t.NdefSocialRecord.SocialTagTypeUris[this.socialType],r=String.format(e,this.socialUserName);this.setUri(r)},r.checkIfValid=function(){if(!t.NdefUriRecord.prototype.checkIfValid())return!1;if(null==this.socialUserName||0==this.socialUserName.length)throw new"NdefException(NdefExceptionMessages.ExTelNumberEmpty)";return!0},r.prototype.getSocialUserName=function(){return this.socialUserName},r.prototype.setSocialUserName=function(e){this.socialUserName=e,this.updatePayload()},r.prototype.getSocialType=function(){return this.socialType},r.prototype.setSocialType=function(e){this.socialType=e,this.updatePayload()}}function n(e){"use strict";var t=e.NdefLibrary,r=t.NdefGeoRecord=function(){this.Longitude="",this.Latitude="",this._geoType="",1==arguments.length?(t.NdefUriRecord.call(this,arguments[0]),this.updatePayload()):t.NdefUriRecord.call(this)};r.prototype=new t.NdefUriRecord,r.prototype.constructor=t.NdefGeoRecord,t.NdefGeoRecord.NfcGeoType={GeoUri:0,BingMaps:1,NokiaMapsUri:2,WebRedirect:3,MsDriveTo:4,MsWalkTo:5},t.NdefSocialRecord.GeoTagTypeUris=["geo:{0},{1}","bingmaps:?cp={0}~{1}","http://m.ovi.me/?c={0},{1}","http://NfcInteractor.com/m?c={0},{1}","ms-drive-to:?destination.latitude={0}&destination.longitude={1}","ms-walk-to:?destination.latitude={0}&destination.longitude={1}"],r.prototype.updatePayload=function(){if(null!=this.Latitude&&0!=this.Latitude.length||null!=this.Longitude&&0!=this.Longitude.length){var e=t.NdefSocialRecord.GeoTagTypeUris[this.getGeoType()],r=String.format(e,this.Latitude,this.Longitude);this.setUri(r)}},r.prototype.getLatitude=function(){return this.Latitude},r.prototype.setLatitude=function(e){this.Latitude=e,this.updatePayload()},r.prototype.getLongitude=function(){return this.Longitude},r.prototype.setLongitude=function(e){this.Longitude=e,this.updatePayload()},r.prototype.getGeoType=function(){return this._geoType},r.prototype.setGeoType=function(e){this._geoType=e,this.updatePayload()}}function i(e){"use strict";var t=e.NdefLibrary,r=t.NdefTelRecord=function(){this.telNumber="",1==arguments.length?(t.NdefUriRecord.call(this,arguments[0]),this.parseUriToData(this.getUri())):t.NdefUriRecord.call(this)};t.NdefTelRecord.TelScheme="tel:",r.prototype=new t.NdefUriRecord,r.prototype.constructor=t.NdefTelRecord,t.NdefTelRecord.isRecordType=function(e){if(null==e.getType()||0==e.getType().length)return!1;if(e.getTypeNameFormat()==t.NdefRecord.TypeNameFormatType.NfcRtd&&null!=e.getPayload()&&g(e.getType(),t.NdefUriRecord.UriType)){var r=new t.NdefUriRecord(e);return r.getUri().startsWith(t.NdefTelRecord.TelScheme)}return!1},r.checkIfValid=function(){if(!t.NdefUriRecord.prototype.checkIfValid())return!1;if(null==this.telNumber||0==this.telNumber.length)throw new"NdefException(NdefExceptionMessages.ExTelNumberEmpty)";return!0},r.prototype.getTelNumber=function(){return this.telNumber},r.prototype.setTelNumber=function(e){this.telNumber=e,this.updatePayload()},r.prototype.parseUriToData=function(e){var t=e.replace("tel:","");this.telNumber=t,this.updatePayload()},r.prototype.updatePayload=function(){null!=this.telNumber&&this.telNumber.length>0&&this.setUri(t.NdefTelRecord.TelScheme+this.telNumber)}}function a(e){"use strict";var t=e.NdefLibrary,r=t.NdefUriRecord=function(){this.RawUri=[],this.Uri="",1==arguments.length?t.NdefRecord.call(this,arguments[0]):t.NdefRecord.call(this,t.NdefRecord.TypeNameFormatType.NfcRtd,t.NdefUriRecord.UriType)};t.NdefUriRecord.UriType="U".getBytes(),t.NdefUriRecord.Abbreviations=["","http://www.","https://www.","http://","https://","tel:","mailto:","ftp://anonymous:anonymous@","ftp://ftp.","ftps://","sftp://","smb://","nfs://","ftp://","dav://","news:","telnet://","imap:","rtsp://","urn:","pop:","sip:","sips:","tftp:","btspp://","btl2cap://","btgoep://","tcpobex://","irdaobex://","file://","urn:epc:id:","urn:epc:tag:","urn:epc:pat:","urn:epc:raw:","urn:epc:","urn:nfc:"],t.NdefUriRecord.isRecordType=function(e){return null==e.getType()||0==e.getType().length?!1:e.getTypeNameFormat()==t.NdefRecord.TypeNameFormatType.NfcRtd&&g(e.getType(),t.NdefUriRecord.UriType)},r.prototype=new t.NdefRecord,r.prototype.constructor=t.NdefUriRecord,r.prototype.getRawUri=function(){if(null==this.getPayload()||0==this.getPayload().length)return null;var e=this.getPayload()[0];0!=e&&console.log("NdefExceptionMessages.ExRawUriNoAbbreviation");var t=Array(this.getPayload().length-1),r=this.getPayload();return c(r,1,t,0,r.length-1),t},r.prototype.setRawUri=function(e){var t=Array(e.length+1);t[0]=0,c(e,0,t,1,e.length),this.setPayload(t)},r.prototype.setUri=function(e){for(var r=e,o=0,n=1;t.NdefUriRecord.Abbreviations.length>n;n++)if(r.startsWith(t.NdefUriRecord.Abbreviations[n])){o=n;break}t.NdefUriRecord.Abbreviations[o].length;var i=r.replace(t.NdefUriRecord.Abbreviations[o],""),a=u(i),d=Array(a+1);d[0]=o;var s=encodeURI(i),p=s.getBytes();c(p,0,d,1,p.length),this.setPayload(d)},r.prototype.getUri=function(){var e=this.getPayload();if(null==e||0==e.length)return"";var r=e[0];r>=t.NdefUriRecord.Abbreviations.length&&(r=0);var o=Array(e.length-1);return c(e,1,o,0,e.length-1),t.NdefUriRecord.Abbreviations[r].concat(decodeURI(f(o)))}}function d(e){"use strict";var t=e.NdefLibrary,r=t.NdefTextRecord=function(){if(this.LanguageCode=null,this.text=null,1==arguments.length){if(t.NdefRecord.call(this,arguments[0]),!t.NdefTextRecord.isRecordType(this))throw"NdefException(NdefExceptionMessages.ExInvalidCopy)"}else t.NdefRecord.call(this,t.NdefRecord.TypeNameFormatType.NfcRtd,t.NdefTextRecord.TextType)};r.prototype=new t.NdefRecord,r.prototype.constructor=t.NdefTextRecord,t.NdefTextRecord.TextType="T".getBytes(),t.NdefTextRecord.TextEncodingType={Utf8:0,Utf16:1},t.NdefTextRecord.isRecordType=function(e){return null==e.getType()||0==e.getType().length?(console.log("AHHH"),!1):e.getTypeNameFormat()==t.NdefRecord.TypeNameFormatType.NfcRtd&&g(e.getType(),t.NdefTextRecord.TextType)},r.prototype.setLanguageCode=function(e){this.assemblePayload(e,this.getTextEncoding(),this.getText())},r.prototype.getLanguageCode=function(){if(null==this.getPayload()||0==this.getPayload().length)return"en";var e=this.getPayload()[0],t=63&e,r=Array(t);return c(this.getPayload(),1,r,0,t),decodeURI(f(r))},r.prototype.setText=function(e){this.assemblePayload(this.getLanguageCode(),this.getTextEncoding(),e)},r.prototype.getText=function(){if(null==this.getPayload()||0==this.getPayload().length)return"";var e=63&this.getPayload()[0],t=[];return c(this.getPayload(),1+e,t,0,this.getPayload().length-1-e),f(t)},r.prototype.setTextEncoding=function(e){this.assemblePayload(this.getLanguageCode(),e,this.getText())},r.prototype.getTextEncoding=function(){return null==this.getPayload()||0==this.getPayload().length?t.NdefTextRecord.TextEncodingType.Utf8:0!=(128&this.getPayload()[0])?t.NdefTextRecord.TextEncodingType.Utf16:t.NdefTextRecord.TextEncodingType.Utf8},r.prototype.assemblePayload=function(e,r,o){var n=e.getBytes(),i=o.getBytes(),a=1+n.length+i.length,d=Array(a);d[0]=0,r==t.NdefTextRecord.TextEncodingType.Utf8?d[0]&=127:d[0]|=128,d[0]|=63&n.length,c(n,0,d,1,n.length),c(i,0,d,1+n.length,i.length),this.setPayload(d)}}function s(e){"use strict";var t=e.NdefLibrary,r=t.NdefRecord=function(){if(this._typeNameFormat=t.NdefRecord.TypeNameFormatType.Empty,this._type=[],this._id=[],this._payload=[],2==arguments.length)this._typeNameFormat=arguments[0],null!=arguments[1]&&this.setType(arguments[1]);else if(1==arguments.length){var e=arguments[0];null!=e.getType()&&this.setType(e.getType()),null!=e.getId()&&this.setId(e.getId()),null!=e.getPayload()&&this.setPayload(e.getPayload()),this._typeNameFormat=e.getTypeNameFormat()}else this._typeNameFormat=t.NdefRecord.TypeNameFormatType.Empty};r.TypeNameFormatType={Empty:0,NfcRtd:1,Mime:2,Uri:3,ExternalRtd:4,Unknown:5,Unchanged:6,Reserved:7},r.prototype.getId=function(){return this._id},r.prototype.setId=function(e){return null==e?(this._id=null,void 0):(this._id=[],c(e,this._id,e.length),void 0)},r.prototype.getType=function(){return this._type},r.prototype.setType=function(e){return null==e?(this._type=null,void 0):(this._type=[],c(e,this._type,e.length),void 0)},r.prototype.getPayload=function(){return this._payload},r.prototype.setPayload=function(e){return null==e?(this._payload=null,void 0):(this._payload=[],c(e,this._payload,e.length),void 0)},r.prototype.getTypeNameFormat=function(){return this._typeNameFormat},r.prototype.setTypeNameFormat=function(e){this._typeNameFormat=e},r.prototype.checkSpecializedType=function(){},r.prototype.checkIfValid=function(){if(this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unchanged||this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unknown){if(null!=this._type&&0!=this._type.length)throw"NdefExceptionMessages.ExRecordUnchangedTypeName"}else if(this._typeNameFormat!=t.NdefRecord.TypeNameFormatType.Empty&&(null==this._type||0==this._type.length))throw"NdefExceptionMessages.ExRecordNoType";if(this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unchanged&&null!=this._id&&0!=this._id.length)throw"NdefExceptionMessages.ExRecordUnchangedId";return!0}}function p(e){"use strict";var t=e.NdefLibrary,r=t.NdefMessage=function(){this._records=[],null!=arguments&&arguments.length>0&&c(arguments,this._records,arguments.length)};r.prototype.length=function(){return null==this._records?0:this._records.length},r.prototype.getRecords=function(){return this._records},r.prototype.push=function(e){null!=e&&this._records.push(e)},r.prototype.clear=function(){this._records=[]},t.NdefMessage.fromByteArray=function(e){for(var r=new t.NdefMessage,o=!1,n=!1,i=[],a=new t.NdefRecord,d=0;e.length>d;){var s=0!=(128&e[d]),p=0!=(64&e[d]),u=0!=(32&e[d]),g=0!=(16&e[d]),f=0!=(8&e[d]),h=7&e[d];if(s&&o)throw"NdefExceptionMessages.ExMessageBeginLate";if(!s&&!o)throw"NdefExceptionMessages.ExMessageBeginMissing";if(s&&!o&&(o=!0),p&&n)throw"NdefExceptionMessages.ExMessageEndLate";if(p&&!n&&(n=!0),u&&h!=t.NdefRecord.TypeNameFormatType.Unchanged&&i.length>0)throw"NdefExceptionMessages.ExMessagePartialChunk";var y=1;if(y+=g?1:4,y+=f?1:0,d+y>=e.length)throw"NdefExceptionMessages.ExMessageUnexpectedEnd";var N=e[++d];if(h==t.NdefRecord.TypeNameFormatType.Unchanged&&0!=N)throw"NdefExceptionMessages.ExMessageInvalidChunkedType";var m;g?m=e[++d]:(m=e[++d]<<24,m|=e[++d]<<16,m|=e[++d]<<8,m|=e[++d]<<0);var T;T=f?e[++d]:0;var R=N+m+T;if(d+R>=e.length)throw"NdefExceptionMessages.ExMessageUnexpectedEnd";if(h==t.NdefRecord.TypeNameFormatType.Unchanged&&0!=T)throw"NdefExceptionMessages.ExMessageInvalidChunkedId";if(h!=t.NdefRecord.TypeNameFormatType.Unchanged&&a.setTypeNameFormat(h),N>0){var U=[];c(e,++d,U,0,N),a.setType(U),d+=N-1}if(T>0){var v=[];c(e,++d,v,0,T),a.setId(v),d+=T-1}if(m>0){var x=[];c(e,++d,x,0,m),a.setPayload(x),u?l(i,x):h==t.NdefRecord.TypeNameFormatType.Unchanged?(l(i,x),a.setPayload(i)):a.setPayload(x),d+=m-1}if(u||(r.push(a),a=new t.NdefRecord),!u&&n)break;++d}if(!o&&!n)throw"NdefExceptionMessages.ExMessageNoBeginOrEnd";return r},r.prototype.toByteArray=function(){var e=this._records.length;if(0==e){var r=new t.NdefMessage(new t.NdefRecord);return r.toByteArray()}for(var o=[],n=0;e>n;n++){var i=this._records[n],a=i.getTypeNameFormat();if(0==n&&(a|=128),n==e-1&&(a|=64),(null==i.getPayload()||255>i.getPayload().length)&&(a|=16),null!=i.getId()&&i.getId().length>0&&(a|=8),o.push(a),null!=i.getType()?o.push(i.getType().length):o.push(0),null==i.getPayload())o.push(0);else if(0!=(16&a))o.push(i.getPayload().length);else{var d=i.getPayload().length;o.push(d>>24),o.push(d>>16),o.push(d>>8),o.push(255&d)}null!=i.getId()&&0!=(8&a)&&o.push(i.getId().length),null!=i.getType()&&i.getType().length>0&&l(o,i.getType()),null!=i.getId()&&i.getId().length>0&&l(o,i.getId()),null!=i.getPayload()&&i.getPayload().length>0&&l(o,i.getPayload())}return o}}const c=function(){var e,t,r,o=0,n=0;2===arguments.length?(e=arguments[0],t=arguments[1],r=e.length):3===arguments.length?(e=arguments[0],t=arguments[1],r=arguments[2]):5===arguments.length&&(e=arguments[0],o=arguments[1],t=arguments[2],n=arguments[3],r=arguments[4]);for(var i=o,a=n;r+o>i;i++,a++){if(null===t[a])throw"array index out of bounds exception";t[a]=e[i]}},l=function(e,t){var r,o,n,i=0,a=0;r=t,i=0,o=e,a=e.length,n=t.length;for(var d=i,s=a;n+i>d;d++,s++){if(null===o[s])throw"array index out of bounds exception";o[s]=r[d]}},u=function(e){var t=encodeURI(e);if(-1!=t.indexOf("%")){var r=t.split("%").length-1;0==r&&r++;var o=t.length-3*r;r+=o}else r=t.length;return r},g=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var r=0;e.length>r;++r)if(e[r]!==t[r])return!1;return!0};String.prototype.startsWith=function(e){return this.slice(0,e.length)==e},String.prototype.getBytes=function(){for(var e=[],t=0;this.length>t;++t)e.push(this.charCodeAt(t));return e},String.format=function(){for(var e=arguments[0],t=0;arguments.length-1>t;t++){var r=RegExp("\\{"+t+"\\}","gm");e=e.replace(r,arguments[t+1])}return e};const f=function(e){for(var t="",r=0;e.length>r;r++)t+=String.fromCharCode(parseInt(e[r]));return t};var h=Function,y=(new h("return this")(),function(c){return e(c),t(c),s(c),p(c),a(c),r(c),i(c),o(c),n(c),d(c),c.NdefLibrary});"function"==typeof define&&define.amd?define(function(){return y({})}):y(this)})(this);