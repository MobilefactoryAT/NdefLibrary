/*! lib-ndeflibrary - v0.0.1 - 2014-03-15 - Sebastian HÃ¶barth */
(function(){function e(e){"use strict";e.NdefLibrary=function(e){return e=e||{},this}}function t(e){"use strict";e.NdefLibrary}function n(e){"use strict";var t=e.NdefLibrary,n=t.NdefRecord=function(){if(this._typeNameFormat=t.NdefRecord.TypeNameFormatType.Empty,this._type=[],this._id=[],this._payload=[],2==arguments.length)this._typeNameFormat=arguments[0],null!=arguments[1]&&this.setType(arguments[1]);else if(1==arguments.length){var e=arguments[0];null!=e.getType()&&this.setType(e.getType()),null!=e.getId()&&this.setId(e.getId()),null!=e.getPayload()&&this.setId(e.getPayload()),this._typeNameFormat=e.getTypeNameFormat()}else this._typeNameFormat=t.NdefRecord.TypeNameFormatType.Empty};n.TypeNameFormatType={Empty:0,NfcRtd:1,Mime:2,Uri:3,ExternalRtd:4,Unknown:5,Unchanged:6,Reserved:7},n.prototype.getId=function(){return this._id},n.prototype.setId=function(e){return null==e?(this._id=null,void 0):(this._id=[],a(e,this._id,e.length),void 0)},n.prototype.getType=function(){return this._type},n.prototype.setType=function(e){return null==e?(this._type=null,void 0):(this._type=[],a(e,this._type,e.length),void 0)},n.prototype.getPayload=function(){return this._payload},n.prototype.setPayload=function(e){return null==e?(this._payload=null,void 0):(this._payload=[],a(e,this._payload,e.length),void 0)},n.prototype.getTypeNameFormat=function(){return this._typeNameFormat},n.prototype.setTypeNameFormat=function(e){this._typeNameFormat=e},n.prototype.checkSpecializedType=function(){},n.prototype.checkIfValid=function(){if(this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unchanged||this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unknown){if(null!=this._type&&0!=this._type.length)throw"NdefExceptionMessages.ExRecordUnchangedTypeName"}else if(this._typeNameFormat!=t.NdefRecord.TypeNameFormatType.Empty&&(null==this._type||0==this._type.length))throw"NdefExceptionMessages.ExRecordNoType";if(this._typeNameFormat==t.NdefRecord.TypeNameFormatType.Unchanged&&null!=this._id&&0!=this._id.length)throw"NdefExceptionMessages.ExRecordUnchangedId";return!0}}function r(e){"use strict";var t=e.NdefLibrary,n=t.NdefMessage=function(){this._records=[],null!=arguments&&arguments.length>0&&a(arguments,this._records,arguments.length)};n.prototype.length=function(){return null==this._records?0:this._records.length},n.prototype.getRecords=function(){return this._records},n.prototype.push=function(e){null!=e&&this._records.push(e)},n.prototype.clear=function(){this._records=[]},t.NdefMessage.fromByteArray=function(e){for(var n=new t.NdefMessage,r=!1,o=!1,i=[],d=new t.NdefRecord,p=0;e.length>p;){var g=0!=(128&e[p]),h=0!=(64&e[p]),u=0!=(32&e[p]),y=0!=(16&e[p]),l=0!=(8&e[p]),f=7&e[p];if(g&&r)throw"NdefExceptionMessages.ExMessageBeginLate";if(!g&&!r)throw"NdefExceptionMessages.ExMessageBeginMissing";if(g&&!r&&(r=!0),h&&o)throw"NdefExceptionMessages.ExMessageEndLate";if(h&&!o&&(o=!0),u&&f!=t.NdefRecord.TypeNameFormatType.Unchanged&&i.length>0)throw"NdefExceptionMessages.ExMessagePartialChunk";var c=1;if(c+=y?1:4,c+=l?1:0,p+c>=e.length)throw"NdefExceptionMessages.ExMessageUnexpectedEnd";var m=e[++p];if(f==t.NdefRecord.TypeNameFormatType.Unchanged&&0!=m)throw"NdefExceptionMessages.ExMessageInvalidChunkedType";var N;y?N=e[++p]:(N=e[++p]<<24,N|=e[++p]<<16,N|=e[++p]<<8,N|=e[++p]<<0);var T;T=l?e[++p]:0;var _=m+N+T;if(p+_>=e.length)throw"NdefExceptionMessages.ExMessageUnexpectedEnd";if(f==t.NdefRecord.TypeNameFormatType.Unchanged&&0!=T)throw"NdefExceptionMessages.ExMessageInvalidChunkedId";if(f!=t.NdefRecord.TypeNameFormatType.Unchanged&&d.setTypeNameFormat(f),m>0){var E=[];a(e,++p,E,0,m),d.setType(E),p+=m-1}if(T>0){var v=[];a(e,++p,v,0,T),d.setId(v),p+=T-1}if(N>0){var x=[];a(e,++p,x,0,N),d.setPayload(x),u?s(i,x):f==t.NdefRecord.TypeNameFormatType.Unchanged?(s(i,x),d.setPayload(i)):d.setPayload(x),p+=N-1}if(u||(n.push(d),d=new t.NdefRecord),!u&&o)break;++p}if(!r&&!o)throw"NdefExceptionMessages.ExMessageNoBeginOrEnd";return n},n.prototype.toByteArray=function(){var e=this._records.length;if(0==e){var n=new t.NdefMessage(new t.NdefRecord);return n.toByteArray()}for(var r=[],a=0;e>a;a++){var o=this._records[a],i=o.getTypeNameFormat();if(0==a&&(i|=128),a==e-1&&(i|=64),(null==o.getPayload()||255>o.getPayload().length)&&(i|=16),null!=o.getId()&&o.getId().length>0&&(i|=8),r.push(i),null!=o.getType()?r.push(o.getType().length):r.push(0),null==o.getPayload())r.push(0);else if(0!=(16&i))r.push(o.getPayload().length);else{var d=o.getPayload().length;r.push(d>>24),r.push(d>>16),r.push(d>>8),r.push(255&d)}null!=o.getId()&&0!=(8&i)&&r.push(o.getId().length),null!=o.getType()&&o.getType().length>0&&s(r,o.getType()),null!=o.getId()&&o.getId().length>0&&s(r,o.getId()),null!=o.getPayload()&&o.getPayload().length>0&&s(r,o.getPayload())}return r}}const a=function(){var e,t,n,r=0,a=0;2===arguments.length?(e=arguments[0],t=arguments[1],n=e.length):3===arguments.length?(e=arguments[0],t=arguments[1],n=arguments[2]):5===arguments.length&&(e=arguments[0],r=arguments[1],t=arguments[2],a=arguments[3],n=arguments[4]);for(var s=r,o=a;n+r>s;s++,o++){if(null===t[o])throw"array index out of bounds exception";t[o]=e[s]}},s=function(e,t){var n,r,a,s=0,o=0;n=t,s=0,r=e,o=e.length,a=t.length;for(var i=s,d=o;a+s>i;i++,d++){if(null===r[d])throw"array index out of bounds exception";r[d]=n[i]}};var o=Function,i=(new o("return this")(),function(a){return e(a),t(a),n(a),r(a),a.NdefLibrary});"function"==typeof define&&define.amd?define(function(){return i({})}):i(this)})(this);